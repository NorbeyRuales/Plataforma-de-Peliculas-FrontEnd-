@use '../../styles/variables' as *;
@use 'sass:color';

.movie-detail {
    display: grid;
    grid-template-columns: 320px 1fr;
    gap: 1.5rem;
    align-items: start;

    @media (max-width: 900px) {
        grid-template-columns: 1fr;
    }

    .poster {
        width: 100%;
        aspect-ratio: 2/3;
        border-radius: $radius;
        overflow: hidden;
        background: color-mix(in srgb, var(--primary) 6%, transparent);
        box-shadow: $shadow;
    }

    .panel {
        background: $card;
        border: 1px solid $border;
        border-radius: $radius;
        box-shadow: $shadow;
        padding: 1rem 1.25rem;
    }

    .title {
        margin: 0 0 .25rem;
        font-size: clamp(1.3rem, 1rem + 1vw, 1.8rem);
    }

    .sub {
        color: $muted;
        margin-bottom: .75rem;
    }

    .tags {
        display: flex;
        flex-wrap: wrap;
        gap: .5rem;
        margin: .5rem 0 1rem;

        .chip {
            display: inline-flex;
            align-items: center;
            gap: .35rem;
            padding: .25rem .55rem;
            border-radius: 999px;
            background: color-mix(in srgb, #6b7280 10%, transparent);
            border: 1px solid color.change($slate, $alpha: .18);
            color: $text;
            font-size: .85rem;
        }
    }

    .actions {
        display: flex;
        gap: .5rem;
        flex-wrap: wrap;
        margin: .75rem 0 1rem;
    }

    .play {
        @include btn($brand, #fff);
    }

    .fav {
        @include btn($secondary, #111);
    }

    /* Reproductor / video */
    .player {
        position: relative;
        display: flex;
        flex-direction: column;
        gap: 1rem;
        margin: 1rem 0;

        video {
            width: 100%;
            max-width: 100%;
            border-radius: $radius;
            object-fit: cover;
            background: $card;
        }

        /* === CONTENEDOR “PASTILLA” PARA LOS CONTROLES === */
        .toolbar {
            display: flex;
            align-items: center;
            gap: .75rem;
            flex-wrap: wrap;

            /* pastilla/card */
            background: $card;
            border: 1px solid $border;
            border-radius: 23px;
            /* forma de píldora */
            padding: .6rem .75rem;
            box-shadow: $shadow;
            overflow: hidden;
            /* recorte suave si se apila en 2 líneas */
            min-height: 46px;
            /* altura cómoda */
        }

        .toolbar .group {
            display: inline-flex;
            gap: .5rem;
            flex-wrap: wrap;
        }

        .toolbar .spacer {
            flex: 1 1 auto;
        }

        .toolbar .ctrl {
            border: 1px solid $border;
            background: $card;
            color: $text;
            border-radius: 999px;
            padding: .45rem .7rem;
            line-height: 1;
            box-shadow: $shadow;
            cursor: pointer;
            font-size: .95rem;

            &:hover {
                filter: brightness(1.05);
            }

            &[disabled] {
                opacity: .5;
                cursor: not-allowed;
            }

            &[aria-pressed="true"] {
                background: color-mix(in srgb, var(--primary, #2266ff) 12%, transparent);
                border-color: color-mix(in srgb, var(--primary, #2266ff) 40%, transparent);
            }
        }

        .toolbar .volume {
            display: inline-flex;
            align-items: center;
            gap: .4rem;

            .range {
                width: clamp(120px, 18vw, 260px);
                accent-color: var(--primary, #2266ff);
            }
        }

        .toolbar .rate {
            display: inline-flex;
            align-items: center;

            select {
                border: 1px solid $border;
                background: $card;
                color: $text;
                border-radius: 8px;
                padding: .25rem .4rem;
            }
        }

        .actions--video {
            justify-content: center;

            .btn.primary {
                min-width: 280px;
            }
        }
    }

    .description {
        width: 100%;
        border: 1px solid $border;
        border-radius: 8px;
        padding: .75rem;
        background: #fff;
        color: #111;
        resize: none;
        overflow: auto;
    }

    html[data-theme='dark'] .movie-detail .description {
        background: $card;
        color: $text;
    }

    .btn.primary.is-active {
        background: color-mix(in srgb, var(--primary, #2266ff) 70%, #000 30%);
    }

    @media (max-width: 900px) {

        .player video,
        .poster {
            width: 100%;
        }
    }
}

/* Variante “single” para centrar título y panel */
.movie-detail--single {
    display: block;
    /* sin grid en esta vista */
}

.movie-detail--single .detail-title {
    text-align: center;
    margin: 0 0 .75rem;
    font-size: clamp(1.8rem, 1.2rem + 2.2vw, 2.4rem);
}

.movie-detail--single .player {
    max-width: 980px;
    margin: 0 auto 1rem;
}

/* ancho del bloque */
.container.movie-detail {
    max-width: 1200px;
    margin-inline: auto;
    padding-inline: clamp(.75rem, 2vw, 1.25rem);
}

/* ===== SINOPSIS: botón Ver más / Ver menos con estilo “pastilla” ===== */
.movie-detail .movie-synopsis {
    margin-top: 1.25rem;
    line-height: 1.65;
    max-width: 72ch;

    .linklike {
        /* Mismo look & feel que .toolbar .ctrl */
        display: inline-flex;
        align-items: center;
        gap: .35rem;

        border: 1px solid $border;
        background: $card;
        color: $text;
        border-radius: 999px;
        padding: .45rem .7rem;
        line-height: 1;
        box-shadow: $shadow;
        cursor: pointer;
        font-size: .95rem;
        user-select: none;
        margin-top: .5rem;

        /* Interacción */
        transition: filter .15s ease, background-color .15s ease, border-color .15s ease;

        &:hover {
            filter: brightness(1.05);
        }

        &:active {
            transform: translateY(1px);
        }

        /* Accesibilidad: foco visible */
        &:focus-visible {
            outline: 2px solid var(--primary, #2266ff);
            outline-offset: 2px;
        }

        /* Estado expandido (coincide con las pastillas activas) */
        &[aria-expanded="true"] {
            background: color-mix(in srgb, var(--primary, #2266ff) 12%, transparent);
            border-color: color-mix(in srgb, var(--primary, #2266ff) 40%, transparent);
        }
    }
}